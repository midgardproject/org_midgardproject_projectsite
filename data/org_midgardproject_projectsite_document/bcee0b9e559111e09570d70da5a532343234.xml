<?xml version="1.0" encoding="UTF-8"?>
<midgard_object xmlns="http://www.midgard-project.org/midgard_object/1.8">
  <org_midgardproject_projectsite_document purge="no" action="updated" guid="bcee0b9e559111e09570d70da5a532343234">
    <metadata>
      <creator>f6b665f1984503790ed91f39b11b5392</creator>
      <created>2011-03-23 21:08:44+0000</created>
      <revisor>f6b665f1984503790ed91f39b11b5392</revisor>
      <revised>2011-03-23 21:18:39+0000</revised>
      <revision>5</revision>
      <locker></locker>
      <locked>0001-01-01 00:00:00+0000</locked>
      <approver></approver>
      <approved>0001-01-01 00:00:00+0000</approved>
      <authors></authors>
      <owner></owner>
      <schedulestart>0001-01-01 00:00:00+0000</schedulestart>
      <scheduleend>0001-01-01 00:00:00+0000</scheduleend>
      <hidden>0</hidden>
      <navnoentry>0</navnoentry>
      <size>7691</size>
      <published>0001-01-01 00:00:00+0000</published>
      <score>0</score>
      <imported>0001-01-01 00:00:00+0000</imported>
      <exported>0001-01-01 00:00:00+0000</exported>
      <deleted>0</deleted>
      <isapproved>0</isapproved>
      <islocked>0</islocked>
    </metadata>
    <action></action>
    <id>8</id>
    <product>4e20cbcc556711e0bf9f557e78066d206d20</product>
    <title>Midgard content schemas</title>
    <content>&amp;lt;div&amp;gt;&amp;lt;p&amp;gt;Midgard2 objects are defined using MgdSchema XML configuration files. Their classes are automatically registered for usage in applications and are described using MgdSchema file attributes and properties.&amp;lt;/p&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;h3&amp;gt;Naming Conventions&amp;lt;/h3&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;p&amp;gt;Due to language binding limitations, type names should be in lowercase and use underscores as word separators. You should follow this convention if you want to define schema types for midgard-java and midgard-php applications.&amp;lt;/p&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;p&amp;gt;Temporary files with '.' or '#' prefixes, or with a '#' suffix will be ignored and warning messages will be printed to the log file or directly to the terminal window.&amp;lt;/p&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;h3&amp;gt;Schema Structure&amp;lt;/h3&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;Here's a simple example:&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;pre&amp;gt;&amp;amp;lt;?xml version="1.0" encoding="UTF-8"?&amp;amp;gt;&amp;lt;br /&amp;gt;&amp;amp;lt;Schema xmlns="http://www.midgard-project.org/repligard/1.4"&amp;amp;gt;&amp;lt;br /&amp;gt;    &amp;amp;lt;type name="example_article" table="example_article"&amp;amp;gt;&amp;lt;br /&amp;gt;        &amp;amp;lt;property name="id" type="unsigned integer" primaryfield="id" /&amp;amp;gt;&amp;lt;br /&amp;gt;        &amp;amp;lt;property name="title" type="string" /&amp;amp;gt;&amp;lt;br /&amp;gt;        &amp;amp;lt;property name="content" type="text" /&amp;amp;gt;&amp;lt;br /&amp;gt;    &amp;amp;lt;/type&amp;amp;gt;&amp;lt;br /&amp;gt;&amp;amp;lt;/Schema&amp;amp;gt;&amp;lt;/pre&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;h3&amp;gt;Loading Schema Files&amp;lt;/h3&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;p&amp;gt;When an application starts up, Midgard2 parses the main schema file &amp;lt;i&amp;gt;MidgardObjects.xml&amp;lt;/i&amp;gt; which defines all the built-in types like &amp;lt;i&amp;gt;midgard_person&amp;lt;/i&amp;gt; and &amp;lt;i&amp;gt;midgard_attachment&amp;lt;/i&amp;gt;.&amp;lt;/p&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;p&amp;gt;To load additional MgdSchema files, place them into your &amp;lt;i&amp;gt;/usr/share/midgard2/schema&amp;lt;/i&amp;gt; directory (this may be different if you chose another prefix during midgard-core compilation).&amp;lt;/p&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;p&amp;gt;If you want to use a custom schema loading path, you can set it using the &amp;lt;i&amp;gt;ShareDir&amp;lt;/i&amp;gt; setting of your Midgard configuration file.&amp;lt;/p&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;h3&amp;gt;Writing Midgard Schemas&amp;lt;/h3&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;p&amp;gt;For every newly-defined type, mandatory attributes have to be set. To define a new MySuperClass type, use the &amp;lt;i&amp;gt;type&amp;lt;/i&amp;gt; element:&amp;lt;/p&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;pre&amp;gt;&amp;amp;lt;type name="MySuperClass"&amp;amp;gt;&amp;lt;br /&amp;gt;&amp;amp;lt;/type&amp;amp;gt;&amp;lt;/pre&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;p&amp;gt;This is sufficient to create a new type and initialize the corresponding new class when the schema is loaded. Such a type is accessible on the bindings level as the &amp;lt;i&amp;gt;MySuperClass&amp;lt;/i&amp;gt; class.&amp;lt;/p&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;h4&amp;gt;Defining Storage Locations&amp;lt;/h4&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;p&amp;gt;Empty classes may be constructed without storage (i.e. a corresponding database table) defined. To set the table name for a particular type, the XML property &amp;lt;i&amp;gt;table&amp;lt;/i&amp;gt; should be used:&amp;lt;/p&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;pre&amp;gt;&amp;amp;lt;type name="MySuperClass" table="my_table"&amp;amp;gt;&amp;lt;br /&amp;gt;&amp;amp;lt;/type&amp;amp;gt;&amp;lt;/pre&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;h4&amp;gt;Defining Properties&amp;lt;/h4&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;p&amp;gt;To define class members (object properties) for a new type, use property elements for child attributes:&amp;lt;/p&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;pre&amp;gt;&amp;amp;lt;type name="MySuperClass" table="my_table"&amp;amp;gt;&amp;lt;br /&amp;gt;    &amp;amp;lt;property name="title" type="string" /&amp;amp;gt;&amp;lt;br /&amp;gt;&amp;amp;lt;/type&amp;amp;gt;&amp;lt;/pre&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;p&amp;gt;When using Midgard2 with your programming language this means there will be a class MySuperClass available with a property title.&amp;lt;/p&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;h4&amp;gt;Settting the Property Type&amp;lt;/h4&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;p&amp;gt;By default all properties are string type, unless another type is distinctly set. Available data types are:&amp;lt;/p&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;ul&amp;gt;&amp;lt;li&amp;gt;string&amp;lt;/li&amp;gt;&amp;lt;li&amp;gt;integer&amp;lt;/li&amp;gt;&amp;lt;li&amp;gt;unsigned integer&amp;lt;/li&amp;gt;&amp;lt;li&amp;gt;text&amp;lt;/li&amp;gt;&amp;lt;li&amp;gt;float&amp;lt;/li&amp;gt;&amp;lt;li&amp;gt;bool&amp;lt;/li&amp;gt;&amp;lt;li&amp;gt;datetime&amp;lt;/li&amp;gt;&amp;lt;li&amp;gt;guid&amp;lt;/li&amp;gt;&amp;lt;/ul&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;p&amp;gt;For every XML property data type there is a corresponding database data type:&amp;lt;/p&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;ul&amp;gt;&amp;lt;li&amp;gt;string is equal to varchar(255)&amp;lt;/li&amp;gt;&amp;lt;li&amp;gt;integer is equal to int(11) (values can range from -2,147,483,648 to 2,147,483,647)&amp;lt;/li&amp;gt;&amp;lt;li&amp;gt;unsigned integer is equal to int(11) (values can range from 0 to 4,294,967,295)&amp;lt;/li&amp;gt;&amp;lt;li&amp;gt;text is equal to text (or longtext )&amp;lt;/li&amp;gt;&amp;lt;li&amp;gt;float is equal to float&amp;lt;/li&amp;gt;&amp;lt;li&amp;gt;bool is equal to boolean&amp;lt;/li&amp;gt;&amp;lt;li&amp;gt;guid is equal to varchar(80)&amp;lt;/li&amp;gt;&amp;lt;/ul&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;h4&amp;gt;Specifying the Database Data Type&amp;lt;/h4&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;p&amp;gt;The additional XML property dbtype may be used when a specific database type is needed, for example, a property with the string type could use the varchar(80) type instead of varchar(255).&amp;lt;/p&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;pre&amp;gt;&amp;amp;lt;property name="title" type="string" dbtype="varchar(80)"/&amp;amp;gt;&amp;lt;/pre&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;p&amp;gt;or&amp;lt;/p&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;pre&amp;gt;&amp;amp;lt;property name="info" type="string" dbtype="set('auth')"/&amp;amp;gt;&amp;lt;/pre&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;h4&amp;gt;Resolving Property Name and Table Field Conflicts&amp;lt;/h4&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;p&amp;gt;The XML property field can be used if you want the object's property name to be different from the table's column name.&amp;lt;/p&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;pre&amp;gt;&amp;amp;lt;property name="title" type="string" field="otherfield"/&amp;amp;gt;&amp;lt;/pre&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;This describes that object's property 'title' will use the column 'otherfield' as its value storage. This is equal to SQL's &amp;lt;i&amp;gt;SELECT table.otherfield AS title&amp;lt;/i&amp;gt;.&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;h4&amp;gt;Setting the Primary Key&amp;lt;/h4&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;p&amp;gt;When a type has many properties defined and one of those should be used as (or better, point to) the table's primary key, the XML property primaryfield can be used.&amp;lt;/p&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;pre&amp;gt;&amp;amp;lt;property name="primary" type="unsigned integer" primaryfield="id"/&amp;amp;gt;&amp;lt;/pre&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;h4&amp;gt;Setting database index&amp;lt;/h4&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;p&amp;gt;If property's field has special usage (e.g. holds a reference for other record), create index. By default indexes are not created for all properties. To set it, use reserved attribute 'index'.&amp;lt;/p&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;pre&amp;gt;&amp;amp;lt;property="count" type="int" index="yes"/&amp;amp;gt;&amp;lt;/pre&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;p&amp;gt;Note, that by default indexes are created for such properties and fields:&amp;lt;/p&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;ul&amp;gt;&amp;lt;li&amp;gt;up property&amp;lt;/li&amp;gt;&amp;lt;li&amp;gt;parent property&amp;lt;/li&amp;gt;&amp;lt;li&amp;gt;property which is a link&amp;lt;/li&amp;gt;&amp;lt;li&amp;gt;property which is a link target (is linked)&amp;lt;/li&amp;gt;&amp;lt;/ul&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;p&amp;gt;Do not create indexes for boolean properties, as it won't improve performance.&amp;lt;/p&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;h4&amp;gt;Defining Tree Hierarchies&amp;lt;/h4&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;p&amp;gt;MgdSchema is able to create tree hierarchies. Objects of the same type may be managed in a tree structure by using the XML property upfield. For defining a type as a 'child' object of another type, the XML properties parentfield and parent should be used.&amp;lt;/p&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;ul&amp;gt;&amp;lt;li&amp;gt;upfield is defined as property of an XML 'property' attribute&amp;lt;/li&amp;gt;&amp;lt;li&amp;gt;parentfield is defined as property of an XML 'property' attribute&amp;lt;/li&amp;gt;&amp;lt;li&amp;gt;parent is defined as property of an XML 'type' attribute&amp;lt;/li&amp;gt;&amp;lt;/ul&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;p&amp;gt;Properties which are parentfield or upfield must be the type of unsigned integer, guid or string.&amp;lt;/p&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;p&amp;gt;This definition describes the MyClass type, which is a node in the MySuperClass tree, and also may have own nodes with objects of the same (MyClass) Type. Useful methods for such types are documented in MgdSchema object's API (list_childs, is_in_tree, get_by_path).&amp;lt;/p&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;h4&amp;gt;References to Other Types&amp;lt;/h4&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;p&amp;gt;The link attribute's property should be used when the object's property (and the column's record value) holds a pointer to another type. The property's value should hold the primary property value of the referenced type.&amp;lt;/p&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;pre&amp;gt;&amp;amp;lt;property name="creator" &amp;#xA0;type="unsigned integer" link="midgard_person:id"/&amp;amp;gt;&amp;lt;/pre&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;p&amp;gt;The special &amp;lt;i&amp;gt;:&amp;lt;/i&amp;gt; separator describes which property of the referenced type should be used as the property's value. If this separator is not defined, the guid property of the referenced type is used by default.&amp;lt;/p&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;p&amp;gt;Properties which are links must be the type of unsigned integer, guid or string.&amp;lt;/p&amp;gt;&amp;lt;/div&amp;gt;</content>
  </org_midgardproject_projectsite_document>
</midgard_object>
